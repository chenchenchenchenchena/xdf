<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
	<script src="common/js/zepto.min.js"></script>
	<script src="common/js/ajax.js"></script>
	<style>
		button{
			width: 50px;
			height: 50px;
		}
	</style>
</head>
<body>
	<button class="aaa">
		分享
	</button>
<script>
        var Wxconfig =  {"url" :location.href,"appid" : "wx559791e14e9ce521","secret": "baa4373d5a8750c69b9d1655a2e31370"};
        var Wxconfig_h;
        $.ajax({
            url: url.w_xmor,
            type: 'post',
            dataType: 'json',
            asyns:false,
            data: JSON.stringify(Wxconfig),
            success:function(e){
                // console.log(e)
                Wxconfig_h = e;
                // console.log(Wxconfig_h.timestamp);
                //配置
                wx.config({
                    debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                    appId: Wxconfig.appid,   // 必填，公众号的唯一标识
                    timestamp: Wxconfig_h.timestamp,   // 必填，生成签名的时间戳
                    nonceStr: Wxconfig_h.nonceStr,   // 必填，生成签名的随机串
                    signature: Wxconfig_h.signature, // 必填，签名
                    jsApiList: ["startRecord","stopRecord","uploadVoice","playVoice","downloadVoice"]
                });
                //调用成功
                wx.ready(function(){
                    wx.checkJsApi({
                        jsApiList: ["startRecord","stopRecord","uploadVoice","playVoice","downloadVoice"],
                        success:function(res){
                        }
                    })
                   
                });
                //调用失败
                wx.error(function(res){
                    alert("出错了"+res.errMsg)
                });

            }
        });
        
    $(".aaa").on("touchstart",function(event){
    	wx.onMenuShareTimeline({  
                 title: '1111111', // 分享标题  
                 link:window.location.href,  
                 imgUrl: "c2.png", // 分享图标  
                 success: function () {  
            // 分享成功执行此回调函数  
                    alert('success');  
                 },  
                 cancel: function () {  
                    alert('cancel');  
                 }  
             });  
  
             //分享给朋友  
             wx.onMenuShareAppMessage({  
                 title: '22222', // 分享标题  
                 desc: '22222',  
                 link:window.location.href,  
                 imgUrl: "c2.png", // 分享图标  
                 trigger: function (res) {  
                     // 不要尝试在trigger中使用ajax异步请求修改本次分享的内容，因为客户端分享操作是一个同步操作，这时候使用ajax的回包会还没有返回  
                 },  
                 success: function (res) {  
             // 分享成功执行此回调函数  
                     alert('已分享');  
                 },  
                 cancel: function (res) {  
                     alert('已取消');  
                 },  
                 fail: function (res) {  
                     alert(JSON.stringify(res));  
                 }  
             });  
    });
        
 
</script>

</body>
</html>
